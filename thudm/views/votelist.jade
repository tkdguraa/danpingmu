extends layout.jade
block contents
        #M2.content
          .container-fluid
            .row
              .col-md-12
                .card.card-plain
                  .header
                    h4.title 投票列表
                     span(style="float:right")
                      button.btn.btn-info.btn-fill(type='submit' id='make')创建
                  .content.table-responsive.table-full-width
                    table.table.table-hover
                      thead
                        tr  
                          th NO
                          th 昵称
                          th 内容
                          th 状态
                      tbody
block script
    script(src='/assets/js/jquery.3.2.1.min.js', type='text/javascript')
    script(src='/assets/js/bootstrap.min.js', type='text/javascript')
    // Charts Plugin
    // Notifications Plugin
    script(src='/assets/js/bootstrap-notify.js')
    // Light Bootstrap Table Core javascript and methods for Demo purpose
    script(src='/assets/js/light-bootstrap-dashboard.js?v=1.4.0')
    // Light Bootstrap Table DEMO methods, don't include it in your project!
    script(type='text/javascript').
     var activities = !{items != null? JSON.stringify(items): 'null'}; 
     $(document).ready(function(){
        var cnt = 0;
        console.log(activities);
        $('#M' + $('.content').attr('id')).attr('class','active');
        activities.forEach((act) =>{
          $('tbody').append("<tr id=tr" + cnt + "></tr>");
          $('#tr' + cnt).append($("<td>").text(cnt));
          $('#tr' + cnt).append($("<td>").text(act.title));
          $('#tr' + cnt).append($("<td>").text(act.sub_title));
          $('#tr' + cnt).append($("<td id = td" + cnt + '>').text(act.status));
          $('#tr' + cnt).append($("<td><button class=join id=" + cnt + '>进入</button></td>'));
          console.log(act._id);
          if(act.sub_title == 'OVER')
              $('#td' + cnt).css({'color':'red'});
          else
              $('#td' + cnt).css({'color':'green'});
          cnt++;
        }); 
      });
      $(document).on('click','.join',function(){
          window.location = '/activity/' + activities[$(this).attr('id')]._id;
      })
      $(document).on('click','#make',function(){
          window.location = '/vote/create';
      })



